{
  "version": 3,
  "sources": ["../../../pkgs/web/mobile/src/m-tabs.tsx"],
  "sourcesContent": ["/** @jsx jsx */\nimport { jsx } from '@emotion/react'\nimport { waitUntil } from 'libs'\nimport get from 'lodash.get'\nimport { useCallback, useEffect, useRef } from 'react'\nimport { createPortal } from 'react-dom'\nimport { BaseWindow } from '../../init/src/window'\nimport { useRender } from '../../utils/src/useRender'\n\ndeclare const window: BaseWindow\n\nexport default (props) => {\n  const _ = useRef({\n    active: '',\n    children: null,\n    init: false,\n    tabsContainer: null,\n    firstTab: null,\n  })\n  const meta = _.current\n  const render = useRender()\n  const onClick = useCallback(\n    function (e) {\n      let el: HTMLDivElement = e.target\n      while (!el.classList.contains('tab-link')) {\n        if (el.parentElement) {\n          el = el.parentElement as HTMLDivElement\n        } else {\n          break\n        }\n      }\n      if (el) {\n        const id = el.getAttribute('data-tab').substr(1)\n        meta.active = id\n        document\n          .querySelectorAll('.page-current .tab-link-active')\n          .forEach((e: any) => {\n            e.classList.remove('tab-link-active')\n          })\n\n        document\n          .querySelectorAll(`.page-current [data-tab=\"#${id}\"]`)\n          .forEach((el) => {\n            el.classList.add('tab-link-active')\n          })\n\n        render()\n      }\n    },\n    [meta.children]\n  )\n\n  const applyOnClick = () => {\n    for (let i in props.children) {\n      const id = get(props.children, i + '.props.children.props.id')\n\n      if (id) {\n        waitUntil(\n          () =>\n            document.querySelectorAll(`.page-current [data-tab=\"#${id}\"]`)\n              .length > 0\n        ).then(() => {\n          const els: NodeListOf<HTMLAnchorElement> = document.querySelectorAll(\n            `.page-current [data-tab=\"#${id}\"]`\n          )\n\n          for (let el of els) {\n            if (el) {\n              el.parentElement\n                .querySelectorAll('.tab-link')\n                .forEach((e, idx) => {\n                  e.removeEventListener('click', onClick)\n                  e.addEventListener('click', onClick)\n                })\n\n              if (i === '0') {\n                meta.firstTab = el\n              }\n            }\n          }\n        })\n      }\n    }\n  }\n\n  useEffect(() => {\n    applyOnClick()\n  })\n\n  useEffect(() => {\n    if (!window.mobileTabsActive) {\n      window.mobileTabsActive = {}\n    }\n\n    waitUntil(() => meta.firstTab).then(() => {\n      const id = meta.firstTab.getAttribute('data-tab').substr(1)\n      meta.active = id\n\n      document\n        .querySelectorAll('.page-current .tab-link-active')\n        .forEach((e: any) => {\n          e.classList.remove('tab-link-active')\n        })\n\n      document\n        .querySelectorAll(`.page-current [data-tab=\"#${id}\"]`)\n        .forEach((el) => {\n          el.classList.add('tab-link-active')\n        })\n\n      render()\n    })\n  }, [meta])\n\n  for (let child of props.children) {\n    const cid = get(child, 'props.children.props.id')\n    if (meta.active === cid) {\n      meta.children = child\n    }\n  }\n\n  return (\n    <div className=\"tabs-animated-wrap flex-1 items-stretch \">\n      <div\n        className=\"tabs\"\n        ref={(e) => {\n          if (e) {\n            meta.tabsContainer = e\n          }\n        }}\n      ></div>\n      {meta.tabsContainer && createPortal(meta.children, meta.tabsContainer)}\n    </div>\n  )\n}\n"],
  "mappings": "2TACA,MAAoB,OAEpB,MAAgB,OAChB,EAA+C,OAC/C,EAA6B,OAM7B,GAAO,GAAQ,EAAC,GAAU,CAQxB,GAAM,GAAO,AAPH,aAAO,CACf,OAAQ,GACR,SAAU,KACV,KAAM,GACN,cAAe,KACf,SAAU,OAEG,QACT,EAAS,IACT,EAAU,kBACd,SAAU,EAAG,CACX,GAAI,GAAqB,EAAE,OAC3B,KAAO,CAAC,EAAG,UAAU,SAAS,aACxB,EAAG,eACL,EAAK,EAAG,cAKZ,GAAI,EAAI,CACN,GAAM,GAAK,EAAG,aAAa,YAAY,OAAO,GAC9C,EAAK,OAAS,EACd,SACG,iBAAiB,kCACjB,QAAQ,AAAC,GAAW,CACnB,EAAE,UAAU,OAAO,qBAGvB,SACG,iBAAiB,6BAA6B,OAC9C,QAAQ,AAAC,GAAO,CACf,EAAG,UAAU,IAAI,qBAGrB,MAGJ,CAAC,EAAK,WAGF,EAAe,MAAM,CACzB,OAAS,KAAK,GAAM,SAAU,CAC5B,GAAM,GAAK,cAAI,EAAM,SAAU,EAAI,4BAEnC,AAAI,GACF,EACE,IACE,SAAS,iBAAiB,6BAA6B,OACpD,OAAS,GACd,KAAK,IAAM,CACX,GAAM,GAAqC,SAAS,iBAClD,6BAA6B,OAG/B,OAAS,KAAM,GACb,AAAI,GACF,GAAG,cACA,iBAAiB,aACjB,QAAQ,CAAC,EAAG,IAAQ,CACnB,EAAE,oBAAoB,QAAS,GAC/B,EAAE,iBAAiB,QAAS,KAG5B,IAAM,KACR,GAAK,SAAW,QAxBT,gBAiCrB,gBAAU,IAAM,CACd,MAGF,gBAAU,IAAM,CACd,AAAK,OAAO,kBACV,QAAO,iBAAmB,IAG5B,EAAU,IAAM,EAAK,UAAU,KAAK,IAAM,CACxC,GAAM,GAAK,EAAK,SAAS,aAAa,YAAY,OAAO,GACzD,EAAK,OAAS,EAEd,SACG,iBAAiB,kCACjB,QAAQ,AAAC,GAAW,CACnB,EAAE,UAAU,OAAO,qBAGvB,SACG,iBAAiB,6BAA6B,OAC9C,QAAQ,AAAC,GAAO,CACf,EAAG,UAAU,IAAI,qBAGrB,OAED,CAAC,IAEJ,OAAS,KAAS,GAAM,SAAU,CAChC,GAAM,GAAM,cAAI,EAAO,2BACvB,AAAI,EAAK,SAAW,GAClB,GAAK,SAAW,GAIpB,MACE,UAAC,MAAD,CAAK,UAAU,4CACb,UAAC,MAAD,CACE,UAAU,OACV,IAAK,AAAC,GAAM,CACV,AAAI,GACF,GAAK,cAAgB,MAI1B,EAAK,eAAiB,mBAAa,EAAK,SAAU,EAAK,iBAxH/C",
  "names": []
}
